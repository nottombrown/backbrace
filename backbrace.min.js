(function(){var g,h=function(a,c){return function(){return a.apply(c,arguments)}},j=Object.prototype.hasOwnProperty,f=function(a,c){function b(){this.constructor=a}for(var d in c)j.call(c,d)&&(a[d]=c[d]);b.prototype=c.prototype;a.prototype=new b;a.__super__=c.prototype;return a},i=Array.prototype.indexOf||function(a){for(var c=0,b=this.length;c<b;c++)if(this[c]===a)return c;return-1};g={autoBind:function(){var a,c;a=_.functions(this.constructor.prototype);c=_.without(["autoBind","constructor"].concat(_.functions(Backbone.Collection.prototype),
_.functions(Backbone.Model.prototype),_.functions(Backbone.View.prototype)),"render");return _.each(a,h(function(a){if(_.indexOf(c,a)===-1)return this[a]=_.bind(this[a],this)},this))}};_.extend(Backbone.Collection.prototype,g);_.extend(Backbone.Model.prototype,g);_.extend(Backbone.View.prototype,g);window._.supplement=function(a){_.each(Array.prototype.slice.call(arguments,1),function(c){var b,d,e;e=[];for(b in c)d=c[b],e.push(d!==0&&a[b]==null?a[b]=d:void 0);return e});return a};window.Backbrace=
{};window.Backbrace.Subset=function(){function a(c){this.parent=c!=null?c.parent:void 0;this.filterfn=c!=null?c.filterfn:void 0;if(!(this.parent instanceof Backbone.Collection||this.parent instanceof Backbrace.Subset))throw"Required option: parent must be a Collection or Subset.";if(typeof this.filterfn!=="function")throw"Required option: filterfn must be function mapping Model to boolean.";this.options=c;delete this.options.parent;delete this.options.filterfn;this._bind();this._reset();this.initialize(this.options)}
a.prototype.models=[];a.prototype._bind=function(){this.parent.bind("all",h(function(c){var a;a=arguments[1];switch(c){case "add":case "remove":if(this.filterfn(a))return this._reset(),this.trigger.apply(this,arguments);break;case "refresh":case "reset":return this.update();default:if(c.indexOf("change")===0&&(this.getByCid(a)&&(this.filterfn(a)?this.trigger.apply(this,arguments):(this._reset(),this.trigger("remove",a,this))),!this.getByCid(a)&&this.filterfn(a)))return this._reset(),this.trigger("add",
a,this)}},this));return this._boundOnModelEvent=_.bind(this._onModelEvent,this)};a.prototype.initialize=function(){};a.prototype._reset=function(){this.model=this.parent.model;this.models=this._models();return this.length=this.models.length};a.prototype._models=function(){return _.filter(this.parent.models,this.filterfn)};a.prototype.update=function(){this._reset();this.trigger("reset",this);return this};a.prototype.add=function(c,a){this.parent.add(c,a);return this};a.prototype.remove=function(c,
a){this.parent.remove(c,a);return this};a.prototype.get=function(c){return _.select(this.models,function(a){return a.id===c})[0]};a.prototype.getByCid=function(a){return _.select(this.models,function(b){return b.cid===(a.cid||a)})[0]};a.prototype.at=function(a){return this.models[a]};a.prototype.sort=function(a){this.parent.sort(a);return this};a.prototype.pluck=function(a){return _.map(this.models,function(b){return b.get(a)})};a.prototype.reset=function(a,b){this.parent.reset(a,b);return this};
a.prototype.fetch=function(a){this.parent.fetch(a);return this};a.prototype.create=function(a,b){return this.parent.create(a,b)};a.prototype.parse=function(a){return a};a.prototype.chain=function(){return this.parent.chain()};return a}();_.supplement(Backbrace.Subset.prototype,Backbone.Collection.prototype);_.each(["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","invoke","max","min","sortBy","sortedIndex","toArray","size",
"first","rest","last","without","indexOf","lastIndexOf","isEmpty"],function(a){return Backbrace.Subset.prototype[a]=function(){return _[a].apply(_,[this.models].concat(_.toArray(arguments)))}});window.Backbrace.IndexedSubset=function(){function a(a){this.autoBind();this.parent=a!=null?a.parent:void 0;if(this.parent==null)throw"Required option: parent";this.object=a!=null?a.object:void 0;this.property=a!=null?a.property:void 0;if(this.object!=null&&this.property!=null){this.indices=this.object.get(this.property);
if(this.indices==null)throw"Object property is not present.";this.object.bind("change:"+this.property,h(function(){this.indices=this.object.get(this.property);return this.update()},this))}else if(this.indices=a!=null?a.indices:void 0,this.indices==null)throw"Required option: indices (if object, property not provided).";this._bind();this._reset()}f(a,Backbrace.Subset);a.prototype.filterfn=function(a){return i.call(this.indices,a)>=0};a.prototype._models=function(){return this.parent.filter(h(function(a){var b;
return b=a.id,i.call(this.indices,b)>=0},this))};return a}();window.Backbrace.TableView=function(){function a(){a.__super__.constructor.apply(this,arguments)}f(a,Backbone.View);a.prototype.collection=null;a.prototype.table_options=null;a.prototype.datatable=null;a.prototype.initialize=function(a){this.autoBind();this.el=$(this.el);this.table_options=a.table_options;this._table_rows={};this.collection.bind("add",this._addItem);this.collection.bind("remove",this._removeItem);this.collection.bind("reset",
this.repopulate);return this.collection.bind("change",this._updateItem)};a.prototype.render=function(){this.datatable=this.el.dataTable(this.table_options);this.repopulate();return this};a.prototype.repopulate=function(){this.datatable.fnClearTable();return this.collection.each(this._addItem)};a.prototype._addItem=function(a){var b;b=this.datatable.fnAddData(a.toJSON())[0];return this._table_rows[a.id]=b};a.prototype._removeItem=function(a){a=this._table_rows[a.id];return a==null?void 0:this.datatable.fnDeleteRow(a)};
a.prototype._updateItem=function(a){var b;b=this._table_rows[a.id];if(b!=null)return this.datatable.fnUpdate(a.toJSON(),b),this.trigger("rowchange",b,a.id,this.datatable.fnGetNodes(b))};return a}();window.Backbrace.ListView=function(){function a(){a.__super__.constructor.apply(this,arguments)}f(a,Backbone.View);a.prototype.collection=null;a.prototype.itemView=null;a.prototype.filter=null;a.prototype.initialize=function(a){var b;this.autoBind();this.el=$(this.el);this.itemView=a.itemView;this.filter=
(b=a.filter)!=null?b:function(){return!0};if(typeof this.filter!=="function")throw"filter: Must be function";if(!this.collection)throw"collection: Must be Backbone.Collection";this.collection=a.collection;this.collection.bind("add",this.onCollectionAdd);this.collection.bind("reset",this.onCollectionReset);return this.collection.bind("change",this.onCollectionChange)};a.prototype.onCollectionAdd=function(){return this.render()};a.prototype.onCollectionReset=function(){return this.render()};a.prototype.onCollectionChange=
function(){return this.render()};a.prototype.render=function(){this.el.children(".bb-list-item").remove();_.each(this.collection.filter(this.filter),this._addItem);return this};a.prototype._addItem=function(a){a.view=new this.itemView({model:a});return this.el.append($(a.view.render().el).addClass("bb-list-item"))};return a}();window.Backbrace.TabPaneView=function(){function a(){a.__super__.constructor.apply(this,arguments)}f(a,Backbone.View);a.prototype.initialize=function(a){this.autoBind();this.el=
$(this.el);this.views=a.views;if(a.defaultView!=null)return this.activeView=new this.views[a.defaultView]({el:this.el})};a.prototype.onTabChange=function(a){this.activeView=new this.views[a]({el:this.el});return this.render()};a.prototype.render=function(){var a;this.el.empty();(a=this.activeView)!=null&&a.render();return this};return a}();window.Backbrace.TabBarView=function(){function a(){a.__super__.constructor.apply(this,arguments)}f(a,Backbone.View);a.prototype.initialize=function(){var a,b,
d,e;this.autoBind();this._wrapElement();this.tabs={};e=this.el.children("li");b=0;for(d=e.length;b<d;b++)a=e[b],this.tabs[a.id]=$(a);this.activeTab=this.el.children("li").first().attr("id");return this.update()};a.prototype._wrapElement=function(){var a;a=this;this.el.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.el.children("li").addClass("ui-state-default ui-corner-top");this.el.wrap('<div class="ui-tabs ui-widget" />');return this.el.children("li").each(function(b,
d){$(d).html("<a>"+$(d).text()+"</a>");return $(d).children("a").click(function(){return a.setTab(d.id)})})};a.prototype.update=function(){this.el.children("li").removeClass("ui-tabs-selected ui-state-active");return this.tabs[this.activeTab].addClass("ui-tabs-selected ui-state-active")};a.prototype.setTab=function(a){if(this.tabs[a]!=null)return this.activeTab=a,this.update(),this.trigger("tabchange",a)};a.prototype.getTab=function(){return this.activeTab};return a}();window.Backbrace.buildTabRouter=
function(a,c){var b,d,e,f;b={routes:{}};f=c.views;e=function(c){return b["_tab_"+c]=function(){return a.setTab(c)}};for(d in f)b.routes[d]="_tab_"+d,e(d);return new (Backbone.Router.extend(b))}}).call(this);
